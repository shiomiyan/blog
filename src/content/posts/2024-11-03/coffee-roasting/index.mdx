---
title: ã‚³ãƒ¼ãƒ’ãƒ¼è±†ã®ç„™ç…æ¸©åº¦ã‚’è¨ˆæ¸¬ã—ã¦ã¿ãŸ
date: "2024-11-05"
description: ""
---

ã‚³ãƒ¼ãƒ’ãƒ¼è±†ã®æ‰‹é‹ç„™ç…ã«ãƒãƒã£ã¦ãŠã‚Šã€å®‰å®šã—ãŸç„™ç…ã‚’ã™ã‚‹ãŸã‚ã«ç„™ç…æ¸©åº¦ã‚’è¨ˆæ¸¬ã—ãŸããªã£ãŸã®ã§ã€ã‚„ã£ã¦ã¿ã¾ã—ãŸã€‚

ã¨ã„ã£ã¦ã‚‚[CircuitPythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¿ãŸã„ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://learn.adafruit.com/circuitpython-on-raspberrypi-linux/spi-sensors-devices)ã‚’ãªãã£ã¦ã„ãã ã‘ã§ã™ã€‚

## æº–å‚™ã—ãŸã‚‚ã®

- [Raspberry Pi 4 Model B (RAM 4G)](https://www.switch-science.com/products/6030)
    - ã‚ªãƒ¼ãƒãƒ¼ã‚¹ãƒšãƒƒã‚¯æ„Ÿã¯å¦ã‚ãªã„ãŒã€ã„ã¤ã‹å½¹ã«ç«‹ã¤ã¨æ€ã£ã¦...
- ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ãƒ»ã‚¸ãƒ£ãƒ³ãƒ‘ãƒ¯ã‚¤ãƒ¤
- [Kå‹ç†±é›»å¯¾ã‚¢ãƒ³ãƒ—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆMAX31855ï¼‰](https://akizukidenshi.com/catalog/g/g108218/)
- [Kå‹ç†±é›»å¯¾ãƒ—ãƒ­ãƒ¼ãƒ–](https://www.switch-science.com/products/2976)
- ã¯ã‚“ã ã€ã¯ã‚“ã ã‚´ãƒ†

ã¾ã‚‹ã§åˆå¿ƒè€…ãªã®ã§è‰²ã€…é–“é•ãˆã¾ã—ãŸãŒã€ã¨ã‚Šã‚ãˆãšã“ã®ã‚ãŸã‚ŠãŒå¿…è¦ã§ã—ãŸã€‚
ä¸€é€šã‚Šå¿…è¦ãã†ãªã‚‚ã®ã¯ã‚¹ã‚¤ãƒƒãƒã‚µã‚¤ã‚¨ãƒ³ã‚¹ã§æƒãˆã¤ã¤ã€ä½œæ¥­ã—ã¦ã„ã¦å¿…è¦ã«ãªã£ãŸã‚‚ã®ã¯ç§‹æœˆé›»å­ã«è²·ã„ã«è¡Œãã¾ã—ãŸã€‚

## ãƒ©ã‚ºãƒ‘ã‚¤ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

SSHã€SPI moduleã€I2C moduleã‚’æœ‰åŠ¹åŒ–ã—ã¦ãŠãã¾ã™ã€‚

```shell
sudo raspi-config

# Interface Options -> SSH / SPI / I2C
```

## è‰²ã€…ç¹‹ã

ãƒ©ã‚ºãƒ‘ã‚¤ã®GPIOãƒ”ãƒ³ã«ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰çµŒç”±ã§ç†±é›»å¯¾ã‚¢ãƒ³ãƒ—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¥ç¶šã—ã¾ã™ã€‚

ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã©ãŠã‚Šã«ç¹‹ã„ã§ã„ãã ã‘ã§ã™ã€‚

>![adafruitã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹é…ç·šå›³](./fritzing.png)
>https://learn.adafruit.com/circuitpython-on-raspberrypi-linux/spi-sensors-devices#wiring-2993466

## è¨ˆæ¸¬ã™ã‚‹

å¼•ãç¶šããƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã«å¾“ã†ã ã‘ã§ã™ãŒã€å¾Œã§æ¸©åº¦å¤‰åŒ–ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«CSVã§ãã‚Œã‚‰ã—ã„ãƒ­ã‚°ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚

```python
# SPDX-FileCopyrightText: 2021 ladyada for Adafruit Industries
# SPDX-License-Identifier: MIT

import time
import board
import digitalio
import adafruit_max31855


def main():
    spi = board.SPI()
    cs = digitalio.DigitalInOut(board.D5)
    max31855 = adafruit_max31855.MAX31855(spi, cs)

    start = time.time()
    data = []
    try:
        while True:
            try:
                tempC = max31855.temperature
            except RuntimeError:
                # Ignore `short circuit to ground` error ğŸ”¥
                pass
            else:
                now = time.time()
                data.append([now, tempC])
                print(f"Temperature: {tempC} C")
                print(
                    f"Elapsed: {int(now - start) // 60} min {int(now - start) % 60} sec"
                )
                time.sleep(1.0)

    except KeyboardInterrupt:
        import csv

        filename = f"data/roasting_{int(time.time())}.csv"
        with open(filename, mode="w", encoding="utf-8") as file:
            writer = csv.writer(file)
            writer.writerows(data)


if __name__ == "__main__":
    main()
```

ä½•åº¦ã‹ãƒ†ã‚¹ãƒˆã—ã¦ã„ã‚‹ã¨`RuntimeError: short circuit to ground`ãŒé »ç™ºã™ã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ã€æ¡ã‚Šã¤ã¶ã—ã¾ã—ãŸã€‚  
ãƒ‡ãƒã‚¤ã‚¹ã«ã¯ã‚ã¾ã‚Šè‰¯ããªã•ãã†ã§ã™ãŒã€äººãŒæ­»ã¬ã‚ã‘ã§ã¯ãªã„ã®ã§...

## çµæœã‚’ã‚°ãƒ©ãƒ•ã«å‡ºåŠ›ã™ã‚‹

Jupyterç’°å¢ƒã‚’ç”¨æ„ã—ã¦ã‚°ãƒ©ãƒ•ã«ã—ã¾ã™ã€‚Jupyterã˜ã‚ƒãªãã¦ã‚‚ã„ã„ã®ã§ã™ãŒã€å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªç¾¤ãŒã‚µã‚¯ãƒƒã¨æƒã£ã¦æ¥½ãªã®ã§ã€‚

Dockerå°å…¥æ¸ˆã¿ãªã®ã§ã€é©å½“ã«composeãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨æ„ã—ã¦ç«‹ã¡ä¸Šã’ã¾ã™ã€‚

```yaml
services:
  jupyter:
    image: quay.io/jupyter/scipy-notebook:2024-10-07
    ports:
      - 10000:10000
    command:
      - start-notebook.sh
      - --NotebookApp.token=''
      - --NotebookApp.disable_check_xsrf=True
    environment:
      - JUPYTER_PORT=10000
    volumes:
      - ./jupyter:/home/jovyan/work
      - ./data:/home/jovyan/data
```

![æ¸©åº¦ã‚»ãƒ³ã‚µã®ãƒ†ã‚¹ãƒˆ](./graph.png)
