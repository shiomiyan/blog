---
import type { CollectionEntry } from "astro:content";
import { getFavicon } from "@lib/utils";
import type { CollectionKey } from "astro:content";

type Props = {
	entry: CollectionEntry<CollectionKey>;
};

const { entry } = Astro.props;

// https://docs.astro.build/en/guides/content-collections/#working-with-dates-in-the-frontmatter
const isoDateTime = entry.data.date.toISOString();
const date = isoDateTime.slice(0, 10);

const href =
	entry.collection === "posts"
		? `/${entry.collection}/${entry.slug}`
		: entry.data.link;

const favicon = entry.collection !== "posts" ? await getFavicon(href) : "";
---

<div>
	<span class="whitespace-nowrap text-xs text-gray-600">
		<time datetime={isoDateTime}>{date}</time>:
	</span>
	<a href={href} class="text-base font-semibold hover:underline">
		{entry.data.title}
		{
			entry.collection !== "posts" && favicon && (
				<img
					src={favicon}
					alt="favicon"
					title={entry.collection}
					class="ml-0.5 inline h-4 w-4"
				/>
			)
		}
	</a>
</div>

<style>
	div {
		display: flex;
		flex-wrap: wrap;
		align-items: baseline;
		gap: 0.25rem;
	}

	@media (max-width: 640px) {
		div {
			display: block;
		}
		a {
			display: inline;
		}
	}
</style>
